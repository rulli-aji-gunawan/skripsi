(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6],{49529:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat/[[...chatId]]",function(){return n(71972)}])},71972:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return O},default:function(){return T}});var a=n(61706),r=n(45813),i=n(35250),s=n(91530),u=n.n(s),c=n(61432),o=n(70079),d=n(73925),l=n(62676),f="oai/apps/hasSeenReleaseAnnouncement",p="2023-01-30";function h(e){var t=e.hasSeenOnboardingDate,n=(0,o.useState)(!1),a=n[0],r=n[1];(0,o.useEffect)(function(){r(function(){return!Boolean(l.m.getItem("".concat(f,"/").concat(p)))&&!!t&&t<new Date(p)})},[t]);var s=(0,o.useCallback)(function(){l.m.setItem("".concat(f,"/").concat(p),!0),r(!1)},[]);return(0,i.jsx)(d.Z,{size:"xs",isOpen:a,onModalClose:s,type:"success",title:"",primaryButton:(0,i.jsx)(d.m,{title:"Sounds good!",color:"primary",onClick:s}),children:(0,i.jsxs)("div",{className:"mb-6 flex flex-col gap-6",children:[(0,i.jsx)("div",{className:"text-gray-800 dark:text-white",children:"Jan 30 version update"}),(0,i.jsx)("div",{className:"text-2xl",children:"Here's what's new"}),(0,i.jsx)("div",{className:"prose text-base dark:prose-invert",children:(0,i.jsx)("ul",{children:(0,i.jsx)("li",{children:"Weâ€™ve upgraded the ChatGPT model with improved factuality and mathematical capabilities."})})})]})})}var v=n(68813),m=n(44513),g=n(49690),_=n(66285),x=n(27252),P=n(500),I=n(12762),y=n(98943),j=n(31501),b=n(61079),w=n(89874),C=n(60814),S=n(80836),E=n(36613);n(24638);var Z=function(){return{thread:S.Cv.createTree(),currentLeafId:"root",threadId:null,title:"New chat"}};function k(){return(k=(0,a.Z)(function(e,t,n){var a,i,s;return(0,r.__generator)(this,function(r){switch(r.label){case 0:a=null,r.label=1;case 1:if(r.trys.push([1,4,,5]),!e)return[3,3];return[4,C.ZP.getConversation(e,n,t)];case 2:var u,c,o,d,l;return o=null===(c=Object.values((u=a=r.sent()).mapping).find(function(e){return null===e.parent}))||void 0===c?void 0:c.id,d=new Set,l=new Set,[2,{thread:((u.moderation_results||[]).forEach(function(e){e.blocked?l.add(e.message_id):e.flagged&&d.add(e.message_id)}),i={rootId:o,mapping:Object.keys(u.mapping).reduce(function(e,t){var n,a=u.mapping[t],r=a.parent,i=a.children,s=(0,w.Z)(a,["parent","children"]),c=u.mapping[t].message||S.Cv.createRootMessage();return l.has(c.id)?n=E.sK:d.has(c.id)&&(n=E.Mf),e[t]=(0,j.Z)((0,b.Z)((0,j.Z)({},s),{message:c,children:i||[],parentId:r||"",type:S.uV[c.role]}),n&&{metadata:n}),e},{}),currentLeafId:u.current_node}).mapping||S.Cv.createTree(),currentLeafId:i.currentLeafId||i.rootId||"root",threadId:e,title:a.title||null}];case 3:return[3,5];case 4:return s=r.sent(),console.error(s),[3,5];case 5:return[2,Z()]}})})).apply(this,arguments)}function N(){return(N=(0,a.Z)(function(e){return(0,r.__generator)(this,function(t){switch(t.label){case 0:return[4,function(e,t,n){return k.apply(this,arguments)}(e,!1)];case 1:return[2,t.sent()]}})})).apply(this,arguments)}var O=!0;function T(e){var t=e.user,n=e.accessToken,a=e.features,r=e.pages,s=e.initialData,l=e.accountStatusResponse,f=e.isUserInCanPayGroup,p=e.isProjectWishActive,j=(0,o.useState)(!1),b=j[0],w=j[1],C=(0,o.useMemo)(function(){return P.TJ},[]),S=(0,c.useRouter)(),E=(0,o.useState)(s),k=E[0],O=E[1],T=(0,m.PV)(C.id).getHasSeenOnboardingDate,A=(0,x.g)(function(e){return e.updateFlagValue});(0,o.useEffect)(function(){void 0!==f&&A("isUserInCanPayGroup",f)},[A,f]),(0,o.useEffect)(function(){void 0!==p&&A("projectWish",p)},[A,p]);var R=(0,o.useMemo)(function(){return{app:y.VY,origin:"chat"}},[]);(0,g.Z)("ChatGPT",t,n,R);var D=(0,_.mA)(function(e){return{accountPlan:e.accountPlan,updateAccountPlanWithResponse:e.updateAccountPlanWithResponse}}),M=D.accountPlan,W=D.updateAccountPlanWithResponse;return(0,o.useEffect)(function(){var e;M.hasPaidSubscription!==(null===(e=l.account_plan)||void 0===e?void 0:e.is_paid_subscription_active)&&l&&W(l)},[W,l,M]),(0,o.useEffect)(function(){w(!T())},[T]),(0,o.useEffect)(function(){var e,t=null===(e=S.query.chatId)||void 0===e?void 0:e[0];t!==k.threadId&&(t?(function(e){return N.apply(this,arguments)})(t).then(function(e){return e&&O(e)}):O(Z()))},[n,s.threadId,S.query.chatId,null==k?void 0:k.threadId,]),(0,i.jsx)(P.yP.Provider,{value:C,children:(0,i.jsxs)(I.Af.Provider,{value:R,children:[(0,i.jsx)(d.Z,{isOpen:b,onModalClose:u(),type:"success",title:"",primaryButton:void 0,children:(0,i.jsx)(m.ZP,{onClose:function(){return w(!1)}})}),(0,i.jsx)(h,{hasSeenOnboardingDate:T()}),(0,i.jsx)(v.Z,{initialData:k,features:new Set(a),pages:r},k.threadId)]})})}}},function(e){e.O(0,[960,741,762,979,424,536,97,980,777,377,774,888,179],function(){return e(e.s=49529)}),_N_E=e.O()}]);